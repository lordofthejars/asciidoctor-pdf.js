<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<link href="./redhat/assets/style.css" rel="stylesheet">
</head>
<body>
<header>
  <h1>Quarkus Cheat-Sheet</h1>
  <img class="logo" src="./redhat/assets/quarkus.png"/>
</header>
<section class="content">
<div class="sect1">
<h2 id="_what_is_quarkus"><a class="anchor" href="#_what_is_quarkus"></a><a class="link" href="#_what_is_quarkus">What is Quarkus?</a></h2>
<div class="sectionbody">
<p class=""><a href="https://quarkus.io/">Quarkus</a> is a Kubernetes Native Java stack tailored for GraalVM &amp; OpenJDK HotSpot, crafted from the best of breed Java libraries and standards.
Also focused on developer experience, making things just work with little to no configuration and allowing to do live coding.</p>
<p class="">Cheat-sheet tested with <strong>Quarkus 0.18.0</strong>.</p>
</div>
</div>
<div class="sect1">
<h2 id="_getting_started"><a class="anchor" href="#_getting_started"></a><a class="link" href="#_getting_started">Getting Started</a></h2>
<div class="sectionbody">
<p class="">Quarkus comes with a Maven archetype to scaffold a very simple starting project.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="bash" class="language-bash hljs">mvn io.quarkus:quarkus-maven-plugin:0.18.0:create \
    -DprojectGroupId=org.acme \
    -DprojectArtifactId=getting-started \
    -DclassName="org.acme.quickstart.GreetingResource" \
    -Dpath="/hello"</code></pre>
</div>
</div>
<p class="">This creates a simple JAX-RS resource called <code>GreetingResource</code>.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="java" class="language-java hljs">@Path("/hello")
public class GreetingResource {

    @GET
    @Produces(MediaType.TEXT_PLAIN)
    public String hello() {
        return "hello";
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_extensions"><a class="anchor" href="#_extensions"></a><a class="link" href="#_extensions">Extensions</a></h2>
<div class="sectionbody">
<p class="">Quarkus comes with extensions to integrate with some libraries such as JSON-B, Camel or MicroProfile spec.
To list all available extensions just run:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="bash" class="language-bash hljs">./mvnw quarkus:list-extensions</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
You can use <code>-DsearchPattern=panache</code> to filter out all extensions except the ones matching the expression.
</td>
</tr>
</table>
</div>
<p class="">And to register the extensions into build tool:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="bash" class="language-bash hljs">./mvnw quarkus:add-extension -Dextensions=""</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
<code>extensions</code> property supports CSV format to register more than one extension at once.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_application_lifecycle"><a class="anchor" href="#_application_lifecycle"></a><a class="link" href="#_application_lifecycle">Application Lifecycle</a></h2>
<div class="sectionbody">
<p class="">You can be notified when the application starts/stops by observing <code>StartupEvent</code> and <code>ShutdownEvent</code> events.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="java" class="language-java hljs">@ApplicationScoped
public class ApplicationLifecycle {
    void onStart(@Observes StartupEvent event) {}
    void onStop(@Observes ShutdownEvent event) {}
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_adding_configuration_parameters"><a class="anchor" href="#_adding_configuration_parameters"></a><a class="link" href="#_adding_configuration_parameters">Adding Configuration Parameters</a></h2>
<div class="sectionbody">
<p class="">To add configuration to your application, Quarkus relies on MicroProfile Config spec (<a href="https://github.com/eclipse/microprofile-config" class="bare">https://github.com/eclipse/microprofile-config</a>).</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="java" class="language-java hljs">@ConfigProperty(name = "greetings.message")
String message;

@ConfigProperty(name = "greetings.message",
                defaultValue = "Hello")
String messageWithDefault;

@ConfigProperty(name = "greetings.message")
Optional&lt;String&gt; optionalMessage;</code></pre>
</div>
</div>
<p class="">Properties can be set as:</p>
<div class="ulist">
<ul>
<li>
<p>Environment variables (<code>GREETINGS_MESSAGE</code>).</p>
</li>
<li>
<p>System properties (<code>-Dgreetings.message</code>).</p>
</li>
<li>
<p>Resources <code>src/main/resources/application.properties</code>.</p>
</li>
<li>
<p>External config directory under the current working directory: <code>config/application.properties</code>.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="properties" class="language-properties hljs">greetings.message = Hello World</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
<code>Array</code>, <code>List</code> and <code>Set</code> are supported. The delimiter is comma (<code>,</code>) char and <code>\</code> is the escape char.
</td>
</tr>
</table>
</div>
<p class=""><strong>Configuration Profiles</strong></p>
<p class="">Quarkus allow you to have multiple configuration in the same file (<code>application.properties</code>).</p>
<p class="">The syntax for this is <code>%{profile}.config.key=value</code>.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="properties" class="language-properties hljs">quarkus.http.port=9090
%dev.quarkus.http.port=8181</code></pre>
</div>
</div>
<p class="">HTTP port will be 9090, unless the 'dev' profile is active.</p>
<p class="">Default profiles are:</p>
<div class="ulist">
<ul>
<li>
<p><code>dev</code>: Activated when in development mode (<code>quarkus:dev</code>).</p>
</li>
<li>
<p><code>test</code>: Activated when running tests.</p>
</li>
<li>
<p><code>prod</code>: The default profile when not running in development or test mode</p>
</li>
</ul>
</div>
<p class="">You can create custom profile names by enabling the profile either setting <code>quarkus-profile</code> system property or <code>QUARKUS_PROFILE</code> environment variable.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="properties" class="language-properties hljs">quarkus.http.port=9090
%staging.quarkus.http.port=9999</code></pre>
</div>
</div>
<p class="">And enable it <code>quarkus-profile=staging</code>.</p>
<p class=""><strong>Custom Loader</strong></p>
<p class="">You can implement your own <code>ConfigSource</code> to load configuration from different places than the default ones provided by Quarkus.
For example, database, custom XML, REST Endpoints, &#8230;&#8203;</p>
<p class="">You need to create a new class and implement <code>ConfigSource</code> interface:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="java" class="language-java hljs">package com.acme.config;
public class InMemoryConfig implements ConfigSource {

    private Map&lt;String, String&gt; prop = new HashMap&lt;&gt;();

    public InMemoryConfig() {
        // Init properties
    }

    @Override
    public int getOrdinal() {
        // The highest ordinal takes precedence
        return 900;
    }

    @Override
    public Map&lt;String, String&gt; getProperties() {
        return prop;
    }

    @Override
    public String getValue(String propertyName) {
        return prop.get(propertyName);
    }

    @Override
    public String getName() {
        return "MemoryConfigSource";
    }
}</code></pre>
</div>
</div>
<p class="">Then you need to register the <code>ConfigSource</code> as Java service.
Create a file <code>/META-INF/services/org.eclipse.microprofile.config.spi.ConfigSource</code> with next content:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">com.acme.config.InMemoryConfig</code></pre>
</div>
</div>
<p class=""><strong>Custom Converters</strong></p>
<p class="">You can implement your own conversion types from String.
Implement <code>org.eclipse.microprofile.config.spi.Converter</code> interface:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="java" class="language-java hljs">@Priority(DEFAULT_QUARKUS_CONVERTER_PRIORITY + 100)
public class CustomInstantConverter
    implements Converter&lt;Instant&gt; {

    @Override
    public Instant convert(String value) {
        if ("now".equals(value.trim())) {
            return Instant.now();
        }
        return Instant.parse(value);
    }
}</code></pre>
</div>
</div>
<p class=""><code>@Priority</code> annotation is used to override the default <code>InstantConverter</code>.</p>
<p class="">Then you need to register the <code>Converter</code> as Java service.
Create a file <code>/META-INF/services/org.eclipse.microprofile.config.spi.Converter</code> with next content:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">com.acme.config.CustomInstantConverter</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_injection"><a class="anchor" href="#_injection"></a><a class="link" href="#_injection">Injection</a></h2>
<div class="sectionbody">
<p class="">Quarkus is based on CDI 2.0 to implement injection of code.
It is not fully supported and only a subset of the <a href="https://quarkus.io/guides/cdi-reference">specification is implemented</a>.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="java" class="language-java hljs">@ApplicationScoped
public class GreetingService {

    public String message(String message) {
        return message.toUpperCase();
    }
}</code></pre>
</div>
</div>
<p class="">Scope annotation is mandatory to make the bean discoverable.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="java" class="language-java hljs">@Inject
GreetingService greetingService;</code></pre>
</div>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">
Quarkus is designed with Substrate VM in mind. For this reason, we encourage you to use <em>package-private</em> scope instead of <em>private</em>.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_json_marshallingunmarshalling"><a class="anchor" href="#_json_marshallingunmarshalling"></a><a class="link" href="#_json_marshallingunmarshalling">JSON Marshalling/Unmarshalling</a></h2>
<div class="sectionbody">
<p class="">To work with <code>JSON-B</code> you need to add a dependency:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="bash" class="language-bash hljs">./mvnw quarkus:add-extension
  -Dextensions="io.quarkus:quarkus-resteasy-jsonb"</code></pre>
</div>
</div>
<p class="">Any POJO is marshaled/unmarshalled automatically.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="java" class="language-java hljs">public class Sauce {
    private String name;
    private long scovilleHeatUnits;

    // getter/setters
}</code></pre>
</div>
</div>
<p class="">JSON equivalent:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="json" class="language-json hljs">{
	"name":"Blair's Ultra Death",
	"scovilleHeatUnits": 1100000
}</code></pre>
</div>
</div>
<p class="">In a <code>POST</code> endpoint example:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="java" class="language-java hljs">@POST
@Consumes(MediaType.APPLICATION_JSON)
public Response create(Sauce sauce) {
    // Create Sauce
    return Response.created(URI.create(sauce.getId()))
            .build();
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_validator"><a class="anchor" href="#_validator"></a><a class="link" href="#_validator">Validator</a></h2>
<div class="sectionbody">
<p class="">Quarkus uses <a href="https://hibernate.org/validator/">Hibernate Validator</a> to validate input/output of REST services and business services using Bean validation spec.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="bash" class="language-bash hljs">./mvnw quarkus:add-extension
  -Dextensions="io.quarkus:quarkus-hibernate-validator"</code></pre>
</div>
</div>
<p class="">Annotate POJO objects with validator annotations such as: <code>@NotNull</code>, <code>@Digits</code>, <code>@NotBlank</code>, <code>@Min</code>, <code>@Max</code>, &#8230;&#8203;</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="java" class="language-java hljs">public class Sauce {

    @NotBlank(message = "Name may not be blank")
    private String name;
    @Min(0)
    private long scovilleHeatUnits;

    // getter/setters
}</code></pre>
</div>
</div>
<p class="">To validate that an object is valid you need to annotate where is used with <code>@Valid</code> annotation:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="java" class="language-java hljs">public Response create(@Valid Sauce sauce) {}</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
If a validation error is triggered, a violation report is generated and serialized as JSON. If you want to manipulate the output, you need to catch in the code the <code>ConstraintViolationException</code> exception.
</td>
</tr>
</table>
</div>
<p class=""><strong>Create Your Custom Constraints</strong></p>
<p class="">First you need to create the custom annotation:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="java" class="language-java hljs">@Target({ METHOD, FIELD, ANNOTATION_TYPE, CONSTRUCTOR,
            PARAMETER, TYPE_USE })
@Retention(RUNTIME)
@Documented
@Constraint(validatedBy = { NotExpiredValidator.class})
public @interface NotExpired {

    String message() default "Sauce must not be expired";
    Class&lt;?&gt;[] groups() default { };
    Class&lt;? extends Payload&gt;[] payload() default { };

}</code></pre>
</div>
</div>
<p class="">You need to implement the validator logic in a class that implements <code>ConstraintValidator</code>.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="java" class="language-java hljs">public class NotExpiredValidator
    implements ConstraintValidator&lt;NotExpired, LocalDate&gt;
    {

    @Override
    public boolean isValid(LocalDate value,
                        ConstraintValidatorContext ctx) {
        if ( value == null ) return true;
        LocalDate today = LocalDate.now();
        return ChronoUnit.YEARS.between(today, value) &gt; 0;
    }
}</code></pre>
</div>
</div>
<p class="">And use it normally:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="java" class="language-java hljs">@NotExpired
@JsonbDateFormat(value = "yyyy-MM-dd")
private LocalDate expired;</code></pre>
</div>
</div>
<p class=""><strong>Manual Validation</strong></p>
<p class="">You can call the validation process manually instead of relaying to <code>@Valid</code> by injecting <code>Validator</code> class.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="java" class="language-java hljs">@Inject
Validator validator;</code></pre>
</div>
</div>
<p class="">And use it:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="java" class="language-java hljs">Set&lt;ConstraintViolation&lt;Sauce&gt;&gt; violations =
            validator.validate(sauce);</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_logging"><a class="anchor" href="#_logging"></a><a class="link" href="#_logging">Logging</a></h2>
<div class="sectionbody">
<p class="">You can configure how Quarkus logs:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="properties" class="language-properties hljs">quarkus.log.console.enable=true
quarkus.log.console.level=DEBUG
quarkus.log.console.color=false
quarkus.log.category."com.lordofthejars".level=DEBUG</code></pre>
</div>
</div>
<p class="">Prefix is <code>quarkus.log</code>.</p>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Property</th>
<th class="tableblock halign-left valign-top">Default</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><p class=""><code>console.enable</code></p></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><p class=""><code>true</code></p></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><p class="">Console logging enabled.</p></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><p class=""><code>console.format</code></p></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><p class=""><code>%d{yyyy-MM-dd HH:mm:ss,SSS} %-5p [%c{3.}] (%t) %s%e%n</code></p></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><p class="">Format pattern to use for logging.</p></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><p class=""><code>console.level</code></p></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><p class=""><code>INFO</code></p></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><p class="">Minimum log level.</p></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><p class=""><code>console.color</code></p></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><p class=""><code>INFO</code></p></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><p class="">Allow color rendering.</p></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><p class=""><code>file.enable</code></p></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><p class=""><code>false</code></p></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><p class="">File logging enabled.</p></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><p class=""><code>file.format</code></p></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><p class=""><code>%d{yyyy-MM-dd HH:mm:ss,SSS} %h %N[%i] %-5p [%c{3.}] (%t) %s%e%n</code></p></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><p class="">Format pattern to use for logging.</p></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><p class=""><code>file.level</code></p></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><p class=""><code>ALL</code></p></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><p class="">Minimum log level.</p></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><p class=""><code>file.path</code></p></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><p class=""><code>quarkus.log</code></p></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><p class="">The path to log file.</p></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><p class=""><code>category."&lt;category-name&gt;".level</code></p></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><p class=""><code>INFO</code></p></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><p class="">Minimum level category.</p></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><p class=""><code>level</code></p></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><p class=""><code>INFO</code></p></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><p class="">Default minimum level.</p></div></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect1">
<h2 id="_rest_client"><a class="anchor" href="#_rest_client"></a><a class="link" href="#_rest_client">Rest Client</a></h2>
<div class="sectionbody">
<p class="">Quarkus implements <a href="https://github.com/eclipse/microprofile-rest-client">MicroProfile Rest Client</a> spec:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="bash" class="language-bash hljs">./mvnw quarkus:add-extension
  -Dextensions="io.quarkus:quarkus-smallrye-rest-client"</code></pre>
</div>
</div>
<div class="page-break"></div>
<p class="">To get content from <a href="http://worldclockapi.com/api/json/cet/now" class="bare">http://worldclockapi.com/api/json/cet/now</a> you need to create a service interface:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="java" class="language-java hljs">@Path("/api")
@RegisterRestClient
public interface WorldClockService {

    @GET @Path("/json/cet/now")
    @Produces(MediaType.APPLICATION_JSON)
    WorldClock getNow();

    @GET
    @Path("/json/{where}/now")
    @Produces(MediaType.APPLICATION_JSON)
    WorldClock getSauce(@BeanParam
                    WorldClockOptions worldClockOptions);

}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="java" class="language-java hljs">public class WorldClockOptions {
    @HeaderParam("Authorization")
    String auth;

    @PathParam("where")
    String where;
}</code></pre>
</div>
</div>
<p class="">And configure the hostname at <code>application.properties</code>:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="properties" class="language-properties hljs">org.acme.quickstart.WorldClockService/mp-rest/url=
        http://worldclockapi.com</code></pre>
</div>
</div>
<p class="">Injecting the client:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="java" class="language-java hljs">@Inject
@RestClient
WorldClockService worldClockService;</code></pre>
</div>
</div>
<p class="">If invokation happens within JAX-RS, you can propagate headers from incoming to outgoing by using next property.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="properties" class="language-properties hljs">org.eclipse.microprofile.rest.client.propagateHeaders=
            Authorization,MyCustomHeader</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
You can still use the JAX-RS client without any problem <code>ClientBuilder.newClient().target(&#8230;&#8203;)</code>
</td>
</tr>
</table>
</div>
<p class=""><strong>Adding headers</strong></p>
<p class="">You can customize the headers passed by implementing MicroProfile <code>ClientHeadersFactory</code> annotation:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="java" class="language-java hljs">@RegisterForReflection
public class BaggageHeadersFactory
                implements ClientHeadersFactory {
    @Override
    public MultivaluedMap&lt;String, String&gt; update(
        MultivaluedMap&lt;String, String&gt; incomingHeaders,
        MultivaluedMap&lt;String, String&gt; outgoingHeaders) {}
}</code></pre>
</div>
</div>
<p class="">And registering it in the client using <code>RegisterClientHeaders</code> annotation.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="java" class="language-java hljs">@RegisterClientHeaders(BaggageHeadersFactory.class)
@RegisterRestClient
public interface WorldClockService {}</code></pre>
</div>
</div>
<p class="">Or statically set:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="java" class="language-java hljs">@GET
@ClientHeaderParam(name="X-Log-Level", value="ERROR")
Response getNow();</code></pre>
</div>
</div>
<p class=""><strong>Asynchronous</strong></p>
<p class="">A method on client interface can return a <code>CompletionStage</code> class to be executed asynchronously.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="java" class="language-java hljs">@GET @Path("/json/cet/now")
@Produces(MediaType.APPLICATION_JSON)
CompletionStage&lt;WorldClock&gt; getNow();</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_testing"><a class="anchor" href="#_testing"></a><a class="link" href="#_testing">Testing</a></h2>
<div class="sectionbody">
<p class="">Quarkus archetype adds test dependencies with JUnit 5 and Rest-Assured library to test REST endpoints.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="java" class="language-java hljs">@QuarkusTest
public class GreetingResourceTest {

    @Test
    public void testHelloEndpoint() {
        given()
          .when().get("/hello")
          .then()
             .statusCode(200)
             .body(is("hello"));
    }
}</code></pre>
</div>
</div>
<p class="">Test port can be set in <code>quarkus.http.test-port</code> property.</p>
<p class="">You can also inject the URL where Quarkus is started:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="java" class="language-java hljs">@TestHTTPResource("index.html")
URL url;</code></pre>
</div>
</div>
<p class=""><strong>Quarkus Test Resource</strong></p>
<p class="">You can execute some logic before the first test run (<code>start</code>) and execute some logic at the end of the test suite (<code>stop</code>).</p>
<p class="">You need to create a class implementing <code>QuarkusTestResourceLifecycleManager</code> interface and register it in the test via <code>@QuarkusTestResource</code> annotation.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="java" class="language-java hljs">public class MyCustomTestResource
    implements QuarkusTestResourceLifecycleManager {

    @Override
    public Map&lt;String, String&gt; start() {
        // return system properties that
        // should be set for the running test
        return Collections.emptyMap();
    }

    @Override
    public synchronized void stop() {
    }
}</code></pre>
</div>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">
Returning new system properties implies running parallel tests in different JVMs.
</td>
</tr>
</table>
</div>
<p class="">And the usage:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="java" class="language-java hljs">@QuarkusTestResource(MyCustomTestResource.class)
public class MyTest {
}</code></pre>
</div>
</div>
<p class=""><strong>Mocking</strong></p>
<p class="">If you need to provide an alternative implementation of a service (for testing purposes) you can do it by using CDI <code>@Alternative</code> annotation using it in the test service placed at <code>src/test/java</code>:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="java" class="language-java hljs">@Alternative
@Priority(1)
@ApplicationScoped
public class MockExternalService extends ExternalService {}</code></pre>
</div>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">
This does not work when using native image testing.
</td>
</tr>
</table>
</div>
<p class="">A stereotype annotation <code>io.quarkus.test.Mock</code> is provided declaring <code>@Alternative</code>, <code>@Priority(1)</code> and <code>@Dependent</code>.</p>
<div class="page-break"></div>
<p class=""><strong>Native Testing</strong></p>
<p class="">To test native executables annotate the test with <code>@SubstrateTest</code>.</p>
<div class="page-break"></div>
</div>
</div>
<div class="sect1">
<h2 id="_persistence"><a class="anchor" href="#_persistence"></a><a class="link" href="#_persistence">Persistence</a></h2>
<div class="sectionbody">
<p class="">Quarkus works with JPA(Hibernate) as persistence solution.
But also provides an <a href="https://en.wikipedia.org/wiki/Active_record_pattern">Active Record pattern</a> implementation under Panache project.</p>
<p class="">To use database access you need to add Quarkus JDBC drivers instead of the original ones.
At this time <code>H2</code>, <code>MariaDB</code>, <code>MSSQL</code> and <code>PostgreSQL</code> drivers are supported.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="bash" class="language-bash hljs">./mvnw quarkus:add-extension
  -Dextensions="io.quarkus:quarkus-hibernate-orm-panache,
                io.quarkus:quarkus-jdbc-mariadb"</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="java" class="language-java hljs">@Entity
public class Developer extends PanacheEntity {

    // id field is implicit

    public String name;
}</code></pre>
</div>
</div>
<p class="">And configuration in <code>src/main/resources/application.properties</code>:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="properties" class="language-properties hljs">quarkus.datasource.url=jdbc:mariadb://localhost:3306/mydb
quarkus.datasource.driver=org.mariadb.jdbc.Driver
quarkus.datasource.username=developer
quarkus.datasource.password=developer
quarkus.hibernate-orm.database.generation=update</code></pre>
</div>
</div>
<p class="">List of datasource parameters.</p>
<p class=""><code>quarkus.datasource</code> as prefix is skipped in the next table.</p>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Type</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><p class=""><code>driver</code></p></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><p class=""><code>String</code></p></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><p class=""><code>url</code></p></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><p class=""><code>String</code></p></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><p class=""><code>username</code></p></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><p class=""><code>String</code></p></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><p class=""><code>password</code></p></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><p class=""><code>String</code></p></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><p class=""><code>min-size</code></p></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><p class=""><code>Integer</code></p></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><p class=""><code>max-size</code></p></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><p class=""><code>Integer</code></p></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><p class=""><code>initial-size</code></p></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><p class=""><code>Integer</code></p></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><p class=""><code>background-validation-interval</code></p></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><p class=""><code>java.time.Duration</code></p></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><p class=""><code>acquisition-timeout</code></p></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><p class=""><code>java.time.Duration</code></p></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><p class=""><code>leak-detection-interval</code></p></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><p class=""><code>java.time.Duration</code></p></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><p class=""><code>idle-removal-interval</code></p></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><p class=""><code>java.time.Duration</code></p></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><p class=""><code>transaction-isolation-level</code></p></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><p class=""><code>io.quarkus.agroal.runtime.TransactionIsolationLevel</code></p></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><p class=""><code>enable-metrics</code></p></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><p class=""><code>Boolean</code></p></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><p class=""><code>xa</code></p></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><p class=""><code>Boolean</code></p></div></td>
</tr>
</tbody>
</table>
<p class="">Database operations:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="java" class="language-java hljs">// Insert
Developer developer = new Developer();
developer.name = "Alex";
developer.persist();

// Find All
Developer.findAll().list();

// Find By Query
Developer.find("name", "Alex").firstResult();

// Delete
Developer developer = new Developer();
developer.id = 1;
developer.delete();

// Delete By Query
long numberOfDeleted = Developer.delete("name", "Alex");</code></pre>
</div>
</div>
<p class="">Remember to annotate methods with <code>@Transactional</code> annotation to make changes persisted in the database.</p>
<p class="">If queries start with the keyword <code>from</code> then they are treated as <em>HQL</em> query, if not then next short form is supported:</p>
<div class="ulist">
<ul>
<li>
<p><code>order by</code> which expands to <code>from EntityName order by &#8230;&#8203;</code></p>
</li>
<li>
<p><code>&lt;columnName&gt;</code> which expands to <code>from EntityName where &lt;columnName&gt;=?</code></p>
</li>
<li>
<p><code>&lt;query&gt;</code> which is expanded to <code>from EntityName where &lt;query&gt;</code></p>
</li>
</ul>
</div>
<p class=""><strong>Static Methods</strong></p>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Field</th>
<th class="tableblock halign-left valign-top">Parameters</th>
<th class="tableblock halign-left valign-top">Return</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><p class=""><code>findById</code></p></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><p class=""><code>Object</code></p></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><p class="">Returns object or null if not found.</p></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><p class=""><code>find</code></p></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><p class=""><code>String</code>, [<code>Object&#8230;&#8203;</code>, <code>Map&lt;String, Object&gt;</code>, <code>Parameters</code>]</p></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><p class="">Lists of entities meeting given query with parameters set.</p></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><p class=""><code>find</code></p></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><p class=""><code>String</code>, <code>Sort</code>, [<code>Object&#8230;&#8203;</code>, <code>Map&lt;String, Object&gt;</code>, <code>Parameters</code>]</p></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><p class="">Lists of entities meeting given query with parameters set sorted by <code>Sort</code> attribute/s.</p></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><p class=""><code>findAll</code></p></div></td>
<td class="tableblock halign-left valign-top"><div class="content"></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><p class="">Finds all entities.</p></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><p class=""><code>findAll</code></p></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><p class=""><code>Sort</code></p></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><p class="">Finds all entities sorted by <code>Sort</code> attribute/s.</p></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><p class=""><code>stream</code></p></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><p class=""><code>String</code>, [<code>Object&#8230;&#8203;</code>, <code>Map&lt;String, Object&gt;</code>, <code>Parameters</code>]</p></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><p class=""><code>java.util.stream.Stream</code> of entities meeting given query with parameters set.</p></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><p class=""><code>stream</code></p></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><p class=""><code>String</code>, <code>Sort</code>, [<code>Object&#8230;&#8203;</code>, <code>Map&lt;String, Object&gt;</code>, <code>Parameters</code>]</p></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><p class=""><code>java.util.stream.Stream</code> of entities meeting given query with parameters set sorted by <code>Sort</code> attribute/s.</p></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><p class=""><code>streamAll</code></p></div></td>
<td class="tableblock halign-left valign-top"><div class="content"></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><p class=""><code>java.util.stream.Stream</code> of all entities.</p></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><p class=""><code>streamAll</code></p></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><p class=""><code>Sort</code></p></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><p class=""><code>java.util.stream.Stream</code> of all entities sorted by <code>Sort</code> attribute/s.</p></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><p class=""><code>count</code></p></div></td>
<td class="tableblock halign-left valign-top"><div class="content"></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><p class="">`Number of entities.</p></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><p class=""><code>count</code></p></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><p class=""><code>String</code>, [<code>Object&#8230;&#8203;</code>, <code>Map&lt;String, Object&gt;</code>, <code>Parameters</code>]</p></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><p class="">Number of entities meeting given query with parameters set.</p></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><p class=""><code>deleteAll</code></p></div></td>
<td class="tableblock halign-left valign-top"><div class="content"></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><p class="">Number of deleted entities.</p></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><p class=""><code>delete</code></p></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><p class=""><code>String</code>, [<code>Object&#8230;&#8203;</code>, <code>Map&lt;String, Object&gt;</code>, <code>Parameters</code>]</p></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><p class="">Number of deleted entities meeting given query with parameters set.</p></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><p class=""><code>persist</code></p></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><p class="">[<code>Iterable</code>, <code>Steram</code>, <code>Object&#8230;&#8203;</code>]</p></div></td>
<td class="tableblock halign-left valign-top"><div class="content"></div></td>
</tr>
</tbody>
</table>
<p class="">If entities are defined in external JAR, you need to enable in these projects the <code>Jandex</code> plugin in project.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="xml" class="language-xml hljs">&lt;plugin&gt;
    &lt;groupId&gt;org.jboss.jandex&lt;/groupId&gt;
    &lt;artifactId&gt;jandex-maven-plugin&lt;/artifactId&gt;
    &lt;version&gt;1.0.3&lt;/version&gt;
    &lt;executions&gt;
        &lt;execution&gt;
            &lt;id&gt;make-index&lt;/id&gt;
            &lt;goals&gt;
                &lt;goal&gt;jandex&lt;/goal&gt;
            &lt;/goals&gt;
        &lt;/execution&gt;
    &lt;/executions&gt;
    &lt;dependencies&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.jboss&lt;/groupId&gt;
            &lt;artifactId&gt;jandex&lt;/artifactId&gt;
            &lt;version&gt;2.1.1.Final&lt;/version&gt;
        &lt;/dependency&gt;
    &lt;/dependencies&gt;
&lt;/plugin&gt;</code></pre>
</div>
</div>
<p class=""><strong>DAO pattern</strong></p>
<p class="">Also supports <em>DAO</em> pattern with <code>PanacheRepository&lt;TYPE&gt;</code>.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="java" class="language-java hljs">@ApplicationScoped
public class DeveloperRepository
    implements PanacheRepository&lt;Person&gt; {
   public Person findByName(String name){
     return find("name", name).firstResult();
   }
}</code></pre>
</div>
</div>
<p class=""><strong>Flushing</strong></p>
<p class="">You can force flush operation by calling <code>.flush()</code> or <code>.persistAndFlush()</code> to make it in a single call.</p>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">
This flush is less efficient and you still need to commit transaction.
</td>
</tr>
</table>
</div>
<p class=""><strong>Testing</strong></p>
<p class="">There is a Quarkus Test Resource that starts and stops H2 server before and after test suite.</p>
<p class="">Register next dependency <code>io.quarkus:quarkus-test-h2:test</code>.</p>
<p class="">And annotate the test:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="java" class="language-java hljs">@QuarkusTestResource(H2DatabaseTestResource.class)
public class FlywayTestResources {
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_flyway"><a class="anchor" href="#_flyway"></a><a class="link" href="#_flyway">Flyway</a></h2>
<div class="sectionbody">
<p class="">Quarkus integrates with <a href="https://flywaydb.org/">Flyway</a> to help you on database schema migrations.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="bash" class="language-bash hljs">./mvnw quarkus:add-extension
  -Dextensions="io.quarkus:quarkus-flyway"</code></pre>
</div>
</div>
<p class="">Then place migration files to the migrations folder (<code>classpath:db/migration</code>).</p>
<p class="">You can inject <code>org.flywaydb.core.Flyway</code> to programmatically execute the migration.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="java" class="language-java hljs">@Inject
Flyway flyway;

flyway.migrate();</code></pre>
</div>
</div>
<p class="">Or can be automatically executed by setting <code>migrate-at-start</code> property to <code>true</code>.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="properties" class="language-properties hljs">quarkus.flyway.migrate-at-start=true</code></pre>
</div>
</div>
<p class="">List of Flyway parameters.</p>
<p class=""><code>quarkus.</code> as prefix is skipped in the next table.</p>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Default</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><p class=""><code>flyway.migrate-at-start</code></p></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><p class=""><code>false</code></p></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Flyway migration automatically.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><p class=""><code>flyway.locations</code></p></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><p class=""><code>classpath:db/migration</code></p></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CSV locations to scan recursively for migrations. Supported prefixes <code>classpath</code> and <code>filesystem</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><p class=""><code>flyway.connect-retries</code></p></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><p class="">0</p></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The maximum number of retries when attempting to connect.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><p class=""><code>flyway.schemas</code></p></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><p class="">none</p></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CSV case-sensitive list of schemas managed.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><p class=""><code>flyway.table</code></p></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><p class=""><code>flyway_schema_history</code></p></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The name of Flyway’s schema history table.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><p class=""><code>flyway.sql-migration-prefix</code></p></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><p class=""><code>V</code></p></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Prefix for versioned SQL migrations.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><p class=""><code>flyway.repeatable-sql-migration-prefix</code></p></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><p class=""><code>R</code></p></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Prefix for repeatable SQL migrations.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect1">
<h2 id="_hibernate_search"><a class="anchor" href="#_hibernate_search"></a><a class="link" href="#_hibernate_search">Hibernate Search</a></h2>
<div class="sectionbody">
<p class="">Quarkus integrates with <a href="https://www.elastic.co/products/elasticsearch">Elasticsearch</a> to provide a full-featured full-text search using <a href="https://hibernate.org/search/">Hibernate Search</a> API.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="bash" class="language-bash hljs">./mvnw quarkus:add-extension
  -Dextensions="quarkus-hibernate-search-elasticsearch"</code></pre>
</div>
</div>
<p class="">You need to annotate your model with Hibernate Search API to index it:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="java" class="language-java hljs">@Entity
@Indexed
public class Author extends PanacheEntity {

    @FullTextField(analyzer = "english")
    public String bio;

    @FullTextField(analyzer = "name")
    @KeywordField(name = "firstName_sort",
        sortable = Sortable.YES,
        normalizer = "sort")
    public String firstName;

    @OneToMany
    @IndexedEmbedded
    public List&lt;Book&gt; books;

}</code></pre>
</div>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">
It is not mandatory to use Panache.
</td>
</tr>
</table>
</div>
<p class="">You need to define the analyzers and normalizers defined in annotations.
You only need to implement <code>ElasticsearchAnalysisConfigurer</code> interface and configure it.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="java" class="language-java hljs">public class MyQuarkusAnalysisConfigurer
            implements ElasticsearchAnalysisConfigurer {

    @Override
    public void configure(
        ElasticsearchAnalysisDefinitionContainerContext ctx)
    {
            ctx.analyzer("english").custom()
                .withTokenizer("standard")
                .withTokenFilters("asciifolding",
                    "lowercase", "porter_stem");

        ctx.normalizer("sort").custom()
            .withTokenFilters("asciifolding", "lowercase");
    }
}</code></pre>
</div>
</div>
<p class="">Use Hibernate Search in REST service:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="java" class="language-java hljs">public class LibraryResource {

    @Inject
    EntityManager em;

    @Transactional
    public List&lt;Author&gt; searchAuthors(
        @QueryParam("pattern") String pattern) {
        return Search.getSearchSession(em)
            .search(Author.class)
            .predicate(f -&gt;
                pattern == null || pattern.isEmpty() ?
                    f.matchAll() :
                    f.simpleQueryString()
                        .onFields("firstName",
                            "lastName", "books.title")
                        .matching(pattern)
                )
            .sort(f -&gt; f.byField("lastName_sort")
            .then().byField("firstName_sort"))
            .fetchHits();
    }</code></pre>
</div>
</div>
<p class=""><strong>IMPORTANT</strong> If you are importing data without using Hibernate ORM, you need to index data by using <code>Search.getSearchSession(em).createIndexer()</code> <code>.startAndWait()</code> at startup time.</p>
<p class="">You need to configure the extension in <code>application.properties</code>:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="properties" class="language-properties hljs">quarkus.hibernate-search.elasticsearch.version=7
quarkus.hibernate-search.elasticsearch.
    analysis-configurer=MyQuarkusAnalysisConfigurer
quarkus.hibernate-search.elasticsearch.
    automatic-indexing.synchronization-strategy=searchable
quarkus.hibernate-search.elasticsearch.
    index-defaults.lifecycle.strategy=drop-and-create
quarkus.hibernate-search.elasticsearch.
    index-defaults.lifecycle.required-status=yellow</code></pre>
</div>
</div>
<p class="">List of Hibernate-Elasticsearch properties prefixed with <code>quarkus.hibernate-search.elasticsearch</code>:</p>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><p class=""><code>backends</code></p></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Map of configuration of additional backends.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><p class=""><code>version</code></p></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Version of Elasticsearch</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><p class=""><code>analysis-configurer</code></p></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Class or name of the neab used to configure.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><p class=""><code>hosts</code></p></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">List of Elasticsearch servers hosts.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><p class=""><code>username</code></p></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Username for auth.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><p class=""><code>password</code></p></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Password for auth.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><p class=""><code>connection-timeout</code></p></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Duration of connection timeout.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><p class=""><code>max-connections</code></p></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Max number of connections to servers.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><p class=""><code>max-connections-per-route</code></p></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Max number of connections to server.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><p class=""><code>indexes</code></p></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Per-index specific configuration.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><p class=""><code>discovery.enabled</code></p></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Enables automatic discovery.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><p class=""><code>discovery.refresh-interval</code></p></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Refresh interval of node list.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><p class=""><code>discovery.default-scheme</code></p></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Scheme to be used for the new nodes.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><p class=""><code>automatic-indexing.synchronization-strategy</code></p></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><p class="">Status for which you wait before considering the operation completed (<code>queued</code>,<code>committed</code> or <code>searchable</code>).</p></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><p class=""><code>automatic-indexing.enable-dirty-check</code></p></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">When enabled, re-indexing of is skipped if the changes are on properties that are not used when indexing.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><p class=""><code>index-defaults.lifecycle.strategy</code></p></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><p class="">Index lifecycle (<code>none</code>, <code>validate</code>, <code>update</code>, <code>create</code>, <code>drop-and-create</code>, <code>drop-abd-create-drop</code>)</p></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><p class=""><code>index-defaults.lifecycle.required-status</code></p></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><p class="">Minimal cluster status (<code>green</code>, <code>yellow</code>, <code>red</code>)</p></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><p class=""><code>index-defaults.lifecycle.required-status-wait-timeout</code></p></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Waiting time before failing the bootstrap.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><p class=""><code>index-defaults.refresh-after-write</code></p></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Set if index should be refreshed after writes.</p></td>
</tr>
</tbody>
</table>
<p class="">Possible annotations:</p>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><p class=""><code>@Indexed</code></p></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Register entity as full text index</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><p class=""><code>@FullTextField</code></p></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Full text search. Need to set an analyzer to split tokens.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><p class=""><code>@KeywordField</code></p></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The string is kept as one single token but can be normalized.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><p class=""><code>IndexedEmbedded</code></p></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Include the Book fields into the Author index.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><p class=""><code>@ContainerExtraction</code></p></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><p class="">Sets how to extract a value from container, e.g from a <code>Map</code>.</p></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><p class=""><code>@DocumentId</code></p></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Map an unusual entity identifier to a document identifier.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><p class=""><code>@GenericField</code></p></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Full text index for any supported type.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><p class=""><code>@IdentifierBridgeRef</code></p></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><p class="">Reference to the identifier bridge to use for a <code>@DocumentId</code>.</p></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><p class=""><code>@IndexingDependency</code></p></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">How a dependency of the indexing process to a property should affect automatic reindexing.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><p class=""><code>@ObjectPath</code></p></div></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><p class=""><code>@ScaledNumberField</code></p></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><p class="">For <code>java.math.BigDecimal</code> or <code>java.math.BigInteger</code> that you need higher precision.</p></div></td>
</tr>
</tbody>
</table>
<div class="page-break"></div>
</div>
</div>
<div class="sect1">
<h2 id="_reactive_programming"><a class="anchor" href="#_reactive_programming"></a><a class="link" href="#_reactive_programming">Reactive Programming</a></h2>
<div class="sectionbody">
<p class="">Quarkus implements <a href="https://github.com/eclipse/microprofile-reactive-streams-operators">MicroProfile Reactive spec</a> and uses RXJava2 to provide reactive programming model.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="bash" class="language-bash hljs">./mvnw quarkus:add-extension
  -Dextensions="
    io.quarkus:quarkus-smallrye-reactive-streams-operators"</code></pre>
</div>
</div>
<p class="">Asynchronous HTTP endpoint is implemented by returning Java <code>CompletionStage</code>.
You can create this class either manually or using MicroProfile Reactive Streams spec:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="java" class="language-java hljs">@GET
@Path("/reactive")
@Produces(MediaType.TEXT_PLAIN)
public CompletionStage&lt;String&gt; getHello() {
    return ReactiveStreams.of("h", "e", "l", "l", "o")
    .map(String::toUpperCase)
    .toList()
    .run()
    .thenApply(list -&gt; list.toString());
}</code></pre>
</div>
</div>
<p class="">Creating streams is also easy, you just need to return <code>Publisher</code> object.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="java" class="language-java hljs">@GET
@Path("/stream")
@Produces(MediaType.SERVER_SENT_EVENTS)
public Publisher&lt;String&gt; publishers() {
        return Flowable
        .interval(500, TimeUnit.MILLISECONDS)
        .map(s -&gt; atomicInteger.getAndIncrement())
        .map(i -&gt; Integer.toString(i));
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_reactive_messaging"><a class="anchor" href="#_reactive_messaging"></a><a class="link" href="#_reactive_messaging">Reactive Messaging</a></h2>
<div class="sectionbody">
<p class="">Quarkus relies on MicroProfile <a href="https://github.com/eclipse/microprofile-reactive-messaging">Reactive Messaging spec</a> to implement reactive messaging streams.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="bash" class="language-bash hljs">mvn quarkus:add-extension
    -Dextensions="
        io.quarkus:quarkus-smallrye-reactive-messaging"</code></pre>
</div>
</div>
<p class="">You can just start using in-memory streams by using <code>@Incoming</code> to produce data and <code>@Outgoing</code> to consume data.</p>
<p class="">Produce every 5 seconds one piece of data.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="java" class="language-java hljs">@ApplicationScoped
public class ProducerData {

    @Outgoing("my-in-memory")
    public Flowable&lt;Integer&gt; generate() {
        return Flowable.interval(5, TimeUnit.SECONDS)
                .map(tick -&gt; random.nextInt(100));
    }
}</code></pre>
</div>
</div>
<p class="">If you want to dispatch to all subscribers you can annotate the method with <code>@Broadcast</code>.</p>
<p class="">Consumes generated data from <code>my-in-memory</code> stream.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="java" class="language-java hljs">@ApplicationScoped
public class ConsumerData {
    @Incoming("my-in-memory")
    public void randomNumber(int randomNumber) {
        System.out.println("Received " + randomNumber);
    }
}</code></pre>
</div>
</div>
<p class="">You can also inject an stream as a field:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="java" class="language-java hljs">@Inject
@Stream("my-in-memory") Publisher&lt;Integer&gt; randomRumbers;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="java" class="language-java hljs">@Inject @Stream("generated-price")
Emitter&lt;String&gt; emitter;</code></pre>
</div>
</div>
<p class=""><strong>Patterns</strong></p>
<p class=""><em>REST API &#8594; Message</em></p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="java" class="language-java hljs">@Inject @Stream(“in”)
Emitter&lt;String&gt; emitter;

emitter.send(message);</code></pre>
</div>
</div>
<p class=""><em>Message &#8594; Message</em></p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="java" class="language-java hljs">@Incoming(“in”)
@Outgoing(“out”)
public String process(String in) {
}</code></pre>
</div>
</div>
<p class=""><em>Message &#8594; SSE</em></p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="java" class="language-java hljs">@Inject @Stream(“out”)
Publisher&lt;String&gt; result;

@GET
@Produces(SERVER_SENT_EVENTS)
public Publisher&lt;String&gt; stream() {
    return result;
}</code></pre>
</div>
</div>
<p class=""><em>Message &#8594; Business Logic</em></p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="java" class="language-java hljs">@ApplicationScoped
public class ReceiverMessages {
    @Incoming("prices")
    public void print(String price) {
    }
}</code></pre>
</div>
</div>
<p class="">Possible implementations are:</p>
<p class=""><strong>In-Memory</strong></p>
<p class="">If the stream is not configured then it is assumed to be an in-memory stream, if not then stream type is defined by <code>connector</code> field.</p>
<p class=""><strong>Kafka</strong></p>
<p class="">To integrate with Kafka you need to add next extensions:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="bash" class="language-bash hljs">mvn quarkus:add-extension
    -Dextensions="
    io.quarkus:quarkus-smallrye-reactive-messaging-kafka"</code></pre>
</div>
</div>
<p class="">Then <code>@Outgoing</code>, <code>@Incoming</code> or <code>@Stream</code> can be used.</p>
<p class="">Kafka configuration schema: <code>mp.messaging.[outgoing|incoming].{stream-name}.&lt;property&gt;=&lt;value&gt;</code>.</p>
<p class="">The <code>connector</code> type is <code>smallrye-kafka</code>.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="properties" class="language-properties hljs">mp.messaging.outgoing.generated-price.connector=
    smallrye-kafka
mp.messaging.outgoing.generated-price.topic=
    prices
mp.messaging.outgoing.generated-price.bootstrap.servers=
    localhost:9092
mp.messaging.outgoing.generated-price.value.serializer=
    org.apache.kafka.common.serialization.IntegerSerializer

mp.messaging.incoming.prices.connector=
    smallrye-kafka
mp.messaging.incoming.prices.value.deserializer=
    org.apache.kafka.common.serialization.IntegerDeserializer</code></pre>
</div>
</div>
<p class="">A complete list of supported properties are in Kafka site. For the <a href="https://kafka.apache.org/documentation/#producerconfigs">producer</a> and for <a href="https://kafka.apache.org/documentation/#consumerconfigs">consumer</a></p>
<p class=""><em>JSON-B Serializer/Deserializer</em></p>
<p class="">You can use JSON-B to serialize/deserialize objects.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="bash" class="language-bash hljs">./mvnw quarkus:add-extension
    -Dextensions="quarkus-kafka-client"</code></pre>
</div>
</div>
<p class="">To serialize you can use <code>io.quarkus.kafka.client.serialization.JsonbSerializer</code>.</p>
<p class="">To deserialize you need to extend <code>io.quarkus.kafka.client.serialization.JsonbDeserializer</code> and provide a type.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="java" class="language-java hljs">public class BeerDeserializer
    extends JsonbDeserializer&lt;Beer&gt; {

    public BeerDeserializer() {
        super(Beer.class);
    }

}</code></pre>
</div>
</div>
<p class=""><strong>AMQP</strong></p>
<p class="">To integrate with AMQP you need to add next extensions:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="bash" class="language-bash hljs">./mvnw quarkus:add-extension
    -Dextensions="reactive-messaging-amqp"</code></pre>
</div>
</div>
<p class="">Then <code>@Outgoing</code>, <code>@Incoming</code> or <code>@Stream</code> can be used.</p>
<p class="">AMQP configuration schema: <code>mp.messaging.[outgoing|incoming].{stream-name}.&lt;property&gt;=&lt;value&gt;</code>.
Special properties <code>amqp-username</code> and <code>amqp-password</code> are used to configure AMQP broker credentials.</p>
<p class="">The connector type is <code>smallrye-amqp</code>.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="properties" class="language-properties hljs">amqp-username=quarkus
amqp-password=quarkus
# write
mp.messaging.outgoing.generated-price.connector=
    smallrye-amqp
mp.messaging.outgoing.generated-price.address=
    prices
mp.messaging.outgoing.generated-price.durable=
    true
# read
mp.messaging.incoming.prices.connector=
    smallrye-amqp
mp.messaging.incoming.prices.durable=
    true</code></pre>
</div>
</div>
<p class="">A complete list of supported properties for <a href="https://smallrye.io/smallrye-reactive-messaging/#_interacting_using_amqp">AMQP</a>.</p>
<p class=""><strong>MQTT</strong></p>
<p class="">To integrate with MQTT you need to add next extensions:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="bash" class="language-bash hljs">./mvnw quarkus:add-extension
    -Dextensions="vertx, smallrye-reactive-streams-operators
        smallrye-reactive-messaging"</code></pre>
</div>
</div>
<p class="">And add <code>io.smallrye.reactive:smallrye-reactive-messaging-mqtt-1.0:0.0.10</code> dependency in your build tool.</p>
<p class="">Then <code>@Outgoing</code>, <code>@Incoming</code> or <code>@Stream</code> can be used.</p>
<p class="">MQTT configuration schema: <code>mp.messaging.[outgoing|incoming].{stream-name}.&lt;property&gt;=&lt;value&gt;</code>.</p>
<p class="">The connector type is <code>smallrye-mqtt</code>.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="properties" class="language-properties hljs">mp.messaging.outgoing.topic-price.type=
    smallrye-mqtt
mp.messaging.outgoing.topic-price.topic=
    prices
mp.messaging.outgoing.topic-price.host=
    localhost
mp.messaging.outgoing.topic-price.port=
    1883
mp.messaging.outgoing.topic-price.auto-generated-client-id=
    true

mp.messaging.incoming.prices.type=
    smallrye-mqtt
mp.messaging.incoming.prices.topic=
    prices
mp.messaging.incoming.prices.host=
    localhost
mp.messaging.incoming.prices.port=
    1883
mp.messaging.incoming.prices.auto-generated-client-id=
    true</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_kafka_streams"><a class="anchor" href="#_kafka_streams"></a><a class="link" href="#_kafka_streams">Kafka Streams</a></h2>
<div class="sectionbody">
<p class="">Create streaming queries with the Kafka Streams API.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="bash" class="language-bash hljs">./mvnw quarkus:add-extension
  -Dextensions="kafka-streams"</code></pre>
</div>
</div>
<p class="">You need to initialize <code>org.apache.kafka.streams.KafkaStreams</code> on startup:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="java" class="language-java hljs">private KafkaStreams streams;

void onStart(@Observes StartupEvent ev) {
    Properties props = new Properties();
    // ...
    StreamsBuilder builder = new StreamsBuilder();
    // ...
    streams = new KafkaStreams(builder.build(), props);

    executor = Executors.newSingleThreadExecutor();
    executor.execute(() -&gt; {
        waitForTopicsToBeCreated(bootstrapServers);
        streams.start();
    });
}

void onStop(@Observes ShutdownEvent ev) {
    streams.close();
    executor.shutdown();
}</code></pre>
</div>
</div>
<p class="">And then you can use it.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="java" class="language-java hljs">public List getData() {
    return streams.allMetadataForStore("")
                .stream()
                .map()
                .collect()
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_reactive_postgresql_client"><a class="anchor" href="#_reactive_postgresql_client"></a><a class="link" href="#_reactive_postgresql_client">Reactive PostgreSQL Client</a></h2>
<div class="sectionbody">
<p class="">You can use Reactive PostgreSQL to execute queries to PostreSQL database in a reactive way, instead of using JDBC way.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="bash" class="language-bash hljs">./mvnw quarkus:add-extension
  -Dextensions="io.quarkus:quarkus-reactive-pg-client"</code></pre>
</div>
</div>
<p class="">Database configuration is the same as shown in <a href="#_persistence">Persistence</a> section, but URL is different as it is not a <em>jdbc</em>.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="properties" class="language-properties hljs">quarkus.datasource.url=
    vertx-reactive:postgresql://host:5431/db</code></pre>
</div>
</div>
<p class="">Then you can inject <code>io.reactiverse.axle.pgclient.PgPool</code> class.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="java" class="language-java hljs">@Inject
PgPool client;

CompletionStage&lt;JsonArray&gt; =
    client.query("SELECT * FROM table")
    .thenApply(pgRowSet -&gt; {
        JsonArray jsonArray = new JsonArray();
        PgIterator iterator = pgRowSet.iterator();
        return jsonArray;
    })</code></pre>
</div>
</div>
<div class="page-break"></div>
</div>
</div>
<div class="sect1">
<h2 id="_jwt"><a class="anchor" href="#_jwt"></a><a class="link" href="#_jwt">JWT</a></h2>
<div class="sectionbody">
<p class="">Quarkus implements <a href="https://github.com/eclipse/microprofile-jwt-auth">MicroProfile JWT RBAC spec</a>.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="bash" class="language-bash hljs">mvn quarkus:add-extension
    -Dextensions="io.quarkus:quarkus-smallrye-jwt"</code></pre>
</div>
</div>
<p class="">Minimum JWT required claims: <code>typ</code>, <code>alg</code>, <code>kid</code>, <code>iss</code>, <code>sub</code>, <code>exp</code>, <code>iat</code>, <code>jti</code>, <code>upn</code>, <code>groups</code>.</p>
<p class="">You can inject token by using <code>JsonWebToken</code> or a claim individually by using <code>@Claim</code>.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="java" class="language-java hljs">@Inject
JsonWebToken jwt;

@Inject
@Claim(standard = Claims.preferred_username)
String name;

@Inject
@Claim("groups")
Set&lt;String&gt; groups;</code></pre>
</div>
</div>
<p class="">Set of supported types: <code>String</code>, <code>Set&lt;String&gt;</code>, <code>Long</code>, <code>Boolean, `javax.json.JsonValue</code>, <code>Optional</code>, <code>org.eclipse.microprofile.jwt.ClaimValue</code>.</p>
<p class="">And configuration in <code>src/main/resources/application.properties</code>:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="properties" class="language-properties hljs">mp.jwt.verify.publickey.location=
    META-INF/resources/publicKey.pem
mp.jwt.verify.issuer=
    https://quarkus.io/using-jwt-rbac</code></pre>
</div>
</div>
<p class="">Configuration options:</p>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Default</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><p class=""><code>quarkus.smallrye-jwt.enabled</code></p></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><p class=""><code>true</code></p></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Determine if the jwt extension is enabled.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><p class=""><code>quarkus.smallrye-jwt.realm-name</code></p></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Quarkus-JWT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Name to use for security realm.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><p class=""><code>quarkus.smallrye-jwt.auth-mechanism</code></p></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">MP-JWT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Authentication mechanism.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><p class=""><code>mp.jwt.verify.publickey</code></p></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">none</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Public Key text itself to be supplied as a string.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><p class=""><code>mp.jwt.verify.publickey.location</code></p></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">none</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Relative path or URL of a public key.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><p class=""><code>mp.jwt.verify.issuer</code></p></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">none</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><p class=""><code>iss</code> accepted as valid.</p></div></td>
</tr>
</tbody>
</table>
<p class="">Supported public key formats:</p>
<div class="ulist">
<ul>
<li>
<p>PKCS#8 PEM</p>
</li>
<li>
<p>JWK</p>
</li>
<li>
<p>JWKS</p>
</li>
<li>
<p>JWK Base64 URL</p>
</li>
<li>
<p>JWKS Base64 URL</p>
</li>
</ul>
</div>
<p class="">To send a token to server-side you should use <code>Authorization</code> header: <code>curl -H "Authorization: Bearer eyJraWQiOi&#8230;&#8203;"</code>.</p>
<p class="">To inject claim values, the bean must be <code>@RequestScoped</code> CDI scoped.
If you need to inject claim values in scope with a lifetime greater than <code>@RequestScoped</code> then you need to use <code>javax.enterprise.inject.Instance</code> interface.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="java" class="language-java hljs">@Inject
@Claim(standard = Claims.iat)
private Instance&lt;Long&gt; providerIAT;</code></pre>
</div>
</div>
<p class=""><strong>RBAC</strong></p>
<p class="">JWT <code>groups</code> claim is directly mapped to roles to be used in security annotations.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="java" class="language-java hljs">@RolesAllowed("Subscriber")</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_keycloak"><a class="anchor" href="#_keycloak"></a><a class="link" href="#_keycloak">Keycloak</a></h2>
<div class="sectionbody">
<p class="">Quarkus can use <a href="https://www.keycloak.org/">Keycloak</a> to protect resources using bearer token issued by Keycloak server.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="bash" class="language-bash hljs">mvn quarkus:add-extension
    -Dextensions="io.quarkus:quarkus-keycloak"</code></pre>
</div>
</div>
<div class="page-break"></div>
<p class="">You can get token information by injecting <code>KeycloakSecurityContext</code> object.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="java" class="language-java hljs">@Inject
KeycloakSecurityContext keycloakSecurityContext;</code></pre>
</div>
</div>
<p class="">You can also protect resources with security annotations.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="java" class="language-java hljs">@GET
@RolesAllowed("admin")</code></pre>
</div>
</div>
<p class="">Configure application to Keycloak service in <code>application.properties</code> file.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="properties" class="language-properties hljs">quarkus.keycloak.realm=quarkus
quarkus.keycloak.auth-server-url=http://localhost:8180/auth
quarkus.keycloak.resource=backend-service
quarkus.keycloak.bearer-only=true
quarkus.keycloak.credentials.secret=secret
quarkus.keycloak.policy-enforcer.enable=true
quarkus.keycloak.policy-enforcer.enforcement-mode=PERMISSIVE</code></pre>
</div>
</div>
<p class="">You can see all possible <a href="https://www.keycloak.org/docs/latest/securing_apps/index.html#_java_adapter_config">Configuration parameters here</a>.</p>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
you can also use <code>src/main/resources/keycloak.json</code> standard Keycloak configuration file.
</td>
</tr>
</table>
</div>
<div class="page-break"></div>
</div>
</div>
<div class="sect1">
<h2 id="_jax_rs"><a class="anchor" href="#_jax_rs"></a><a class="link" href="#_jax_rs">JAX-RS</a></h2>
<div class="sectionbody">
<p class="">Quarkus uses JAX-RS to define <a href="https://github.com/jax-rs">REST-ful web APIs</a>.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="java" class="language-java hljs">@Path("/book")
public class BookResource {

    @GET
    @Produces(MediaType.APPLICATION_JSON)
    public List&lt;Book&gt; getAllBooks() {}

    @POST
    @Produces(MediaType.APPLICATION_JSON)
    public Response createBook(Book book) {}

    @DELETE
    @Path("{isbn}")
    @Produces(MediaType.APPLICATION_JSON)
    public Response deleteBook(
        @PathParam("isbn") String isbn) {}


    @GET
    @Produces(MediaType.APPLICATION_JSON)
    @Path("search")
    public Response searchBook(
        @QueryParam("description") String description) {}
}</code></pre>
</div>
</div>
<p class="">To get information from request:</p>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Property</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Example</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><p class=""><code>@PathParam</code></p></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Gets content from request URI.</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><p class=""><code>/book/{id} @PathParam("id")</code></p></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><p class=""><code>@QueryParam</code></p></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Gets query parameter.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/book?desc="" @QueryParam("desc)</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><p class=""><code>@FormParam</code></p></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Gets form parameter.</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><p class=""><code>@MatrixParam</code></p></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Get URI matrix parameter.</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><p class=""><code>/book;author=mkyong;country=malaysia</code></p></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><p class=""><code>@CookieParam</code></p></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Gets cookie param by name.</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><p class=""><code>@HeaderParam</code></p></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Gets header parameter by name.</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
</tbody>
</table>
<p class="">Valid HTTP method annotations provided by the spec are: <code>@GET</code>, <code>@POST</code>, <code>@PUT</code>, <code>@DELETE</code>, <code>@PATCH</code>, <code>@HEAD</code> and <code>@OPTIONS</code>.</p>
<p class="">You can create new annotations that bind to HTTP methods not defined by the spec.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="java" class="language-java hljs">@Target({ElementType.METHOD})
@Retention(RetentionPolicy.RUNTIME)
@HttpMethod("LOCK")
public @interface LOCK {
}

@LOCK
public void lockIt() {}
}</code></pre>
</div>
</div>
<p class=""><strong>Injecting</strong></p>
<p class="">Using <code>@Context</code> annotation to inject JAX-RS and Servlet information.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="java" class="language-java hljs">@GET
public String getBase(@Context UriInfo uriInfo) {
    return uriInfo.getBaseUri();
}</code></pre>
</div>
</div>
<p class="">Possible injectable objects: <code>SecurityContext</code>, <code>Request</code>, <code>Application</code>, <code>Configuration</code>, <code>Providers</code>, <code>ResourceContext</code>, <code>ServletConfig</code>, <code>ServletContext</code>, <code>HttpServletRequest</code>, <code>HttpServletResponse</code>, <code>HttpHeaders</code>, <code>URiInfo</code>, <code>SseEventSink</code> and <code>Sse</code>.</p>
<p class=""><strong>HTTP Filters</strong></p>
<p class="">HTTP request and response can be intercepted to manipulate the metadata (ie headers, parameters, media type, &#8230;&#8203;) or abort a request.
You only need to implement the next <code>ContainerRequestFilter</code> and <code>ContainerResponseFilter</code> JAX-RS interfaces respectively.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="java" class="language-java hljs">@Provider
public class LoggingFilter
        implements ContainerRequestFilter {

    @Context
    UriInfo info;

    @Context
    HttpServletRequest request;

    @Override
    public void filter(ContainerRequestContext context) {
        final String method = context.getMethod();
        final String path = info.getPath();
        final String address = request.getRemoteAddr();
        System.out.println("Request %s %s from IP %s",
                method, path, address);
    }

}</code></pre>
</div>
</div>
<p class=""><strong>Exception Mapper</strong>
You can map exceptions to produce a custom output by implementing <code>ExceptionMapper</code> interface:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="java" class="language-java hljs">@Provider
public class ErrorMapper
    implements ExceptionMapper&lt;Exception&gt; {

    @Override
    public Response toResponse(Exception exception) {
        int code = 500;
        if (exception instanceof WebApplicationException) {
            code = ((WebApplicationException) exception)
                .getResponse().getStatus();
        }
        return Response.status(code)
            .entity(
                Json.createObjectBuilder()
                .add("error", exception.getMessage())
                .add("code", code)
                .build()
            )
            .build();
        }
    }</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_cors_filter"><a class="anchor" href="#_cors_filter"></a><a class="link" href="#_cors_filter">CORS Filter</a></h2>
<div class="sectionbody">
<p class="">Quarkus comes with a CORS filter that can be enabled via configuration:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="properties" class="language-properties hljs">quarkus.http.cors=true</code></pre>
</div>
</div>
<p class="">Prefix is <code>quarkus.http</code>.</p>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Property</th>
<th class="tableblock halign-left valign-top">Default</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><p class=""><code>cors</code></p></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><p class=""><code>false</code></p></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Enable CORS.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><p class="">origins</p></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><p class="">Any request valid.</p></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CSV of origins allowed.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><p class=""><code>methods</code></p></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Any method valid.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CSV of methods valid.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><p class=""><code>headers</code></p></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Any requested header valid.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CSV of valid allowed headers.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><p class=""><code>exposed-headers</code></p></div></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CSV of valid exposed headers.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect1">
<h2 id="_fault_tolerance"><a class="anchor" href="#_fault_tolerance"></a><a class="link" href="#_fault_tolerance">Fault Tolerance</a></h2>
<div class="sectionbody">
<p class="">Quarkus uses <a href="https://github.com/eclipse/microprofile-fault-tolerance">MicroProfile Fault Tolerance</a> spec:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="bash" class="language-bash hljs">./mvnw quarkus:add-extension
  -Dextensions="io.quarkus:quarkus-smallrye-fault-tolerance"</code></pre>
</div>
</div>
<p class="">MicroProfile Fault Tolerance spec uses CDI interceptor and it can be used in several elements such as CDI bean, JAX-RS resource or MicroProfile Rest Client.</p>
<p class="">To do automatic <strong>retries</strong> on a method:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="java" class="language-java hljs">@Path("/api")
@RegisterRestClient
public interface WorldClockService {
    @GET @Path("/json/cet/now")
    @Produces(MediaType.APPLICATION_JSON)
    @Retry(maxRetries = 2)
    WorldClock getNow();
}</code></pre>
</div>
</div>
<p class="">You can set fallback code in case of an error by using <code>@Fallback</code> annotation:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="java" class="language-java hljs">@Retry(maxRetries = 1)
@Fallback(fallbackMethod = "fallbackMethod")
WorldClock getNow(){}

public String fallbackMethod() {
    return "It could beworse";
}</code></pre>
</div>
</div>
<p class=""><code>fallbackMethod</code> must have the same parameters and return type as the annotated method.</p>
<p class="">You can also set logic into a class that implements <code>FallbackHandler</code> interface:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="java" class="language-java hljs">public class RecoverFallback
            implements FallbackHandler&lt;String&gt; {
    @Override
    public String handle(ExecutionContext context) {
    }
}</code></pre>
</div>
</div>
<p class="">And set it in the annotation as value <code>@Fallback(RecoverFallback.class)</code>.</p>
<p class="">In case you want to use <strong>circuit breaker</strong> pattern:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="java" class="language-java hljs">@CircuitBreaker(requestVolumeThreshold = 4,
                failureRatio=0.75,
                delay = 1000)
WorldClock getNow(){}</code></pre>
</div>
</div>
<p class="">If 3 <code>(4 x 0.75)</code> failures occur among the rolling window of 4 consecutive invocations then the circuit is opened for 1000 ms and then be back to half open.
If the invocation succeeds then the circuit is back to closed again.</p>
<div class="page-break"></div>
<p class="">You can use <strong>bulkahead</strong> pattern to limit the number of concurrent access to the same resource.
If the operation is synchronous it uses a semaphore approach, if it is asynchronous a thread-pool one.
When a request cannot be processed <code>BulkheadException</code> is thrown.
It can be used together with any other fault tolerance annotation.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="java" class="language-java hljs">@Bulkhead(5)
@Retry(maxRetries = 4,
       delay = 1000,
       retryOn = BulkheadException.class)
WorldClock getNow(){}</code></pre>
</div>
</div>
<p class="">Fault tolerance annotations:</p>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Annotation</th>
<th class="tableblock halign-left valign-top">Properties</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><p class=""><code>@Timeout</code></p></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><p class=""><code>unit</code></p></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><p class=""><code>@Retry</code></p></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><p class=""><code>maxRetries</code>, <code>delay</code>, <code>delayUnit</code>, <code>maxDuration</code>, <code>durationUnit</code>, <code>jitter</code>, <code>jitterDelayUnit</code>, <code>retryOn</code>, <code>abortOn</code></p></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><p class=""><code>@Fallback</code></p></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><p class=""><code>fallbackMethod</code></p></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><p class=""><code>@Bulkhead</code></p></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><p class=""><code>waitingTaskQueue</code> (only valid in asynchronous)</p></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><p class=""><code>@CircuitBreaker</code></p></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><p class=""><code>failOn</code>, <code>delay</code>, <code>delayUnit</code>, <code>requestVolumeThreshold</code>, <code>failureRatio</code>, <code>successThreshold</code></p></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><p class=""><code>@Asynchronous</code></p></div></td>
<td class="tableblock halign-left valign-top"><div class="content"></div></td>
</tr>
</tbody>
</table>
<p class="">You can override annotation parameters via configuration file using property <code>[classname/methodname/]annotation/parameter</code>:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="properties" class="language-properties hljs">org.acme.quickstart.WorldClock/getNow/Retry/maxDuration=30
# Class scope
org.acme.quickstart.WorldClock/Retry/maxDuration=3000
# Global
Retry/maxDuration=3000</code></pre>
</div>
</div>
<p class="">You can also enable/disable policies using special parameter <code>enabled</code>.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="properties" class="language-properties hljs">org.acme.quickstart.WorldClock/getNow/Retry/enabled=false
# Disable everything except fallback
MP_Fault_Tolerance_NonFallback_Enabled=false</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
MicroProfile Fault Tolerance integrats with MicroProfile Metrics spec. You can disable it by setting <code>MP_Fault_Tolerance_Metrics_Enabled</code> to false.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_observability"><a class="anchor" href="#_observability"></a><a class="link" href="#_observability">Observability</a></h2>
<div class="sectionbody">
<p class=""><strong>Health Checks</strong></p>
<p class="">Quarkus relies on <a href="https://github.com/eclipse/microprofile-health">MicroProfile Health</a> spec to provide health checks.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="bash" class="language-bash hljs">./mvnw quarkus:add-extension
  -Dextensions="io.quarkus:quarkus-smallrye-health"</code></pre>
</div>
</div>
<p class="">By just adding this extension, an endpoint is registered to <code>/health</code> providing a default health check.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="json" class="language-json hljs">{
    "status": "UP",
    "checks": [
    ]
}</code></pre>
</div>
</div>
<p class="">To create a custom health check you need to implement the <code>HealthCheck</code> interface and annotate either with <code>@Readiness</code> (ready to process requests) or <code>@Liveness</code> (is running) annotations.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="java" class="language-java hljs">@Readiness
public class DatabaseHealthCheck implements HealthCheck {
    @Override
    public HealthCheckResponse call() {
        HealthCheckResponseBuilder responseBuilder =
            HealthCheckResponse.named("Database conn");

        try {
            checkDatabaseConnection();
            responseBuilder.withData("connection", true);
            responseBuilder.up();
        } catch (IOException e) {
            // cannot access the database
            responseBuilder.down()
                    .withData("error", e.getMessage());
        }
        return responseBuilder.build();
    }
}</code></pre>
</div>
</div>
<p class="">Builds the next output:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="json" class="language-json hljs">{
    "status": "UP",
    "checks": [
        {
            "name": "Database conn",
            "status": "UP",
            "data": {
                "connection": true
            }
        }
    ]
}</code></pre>
</div>
</div>
<p class="">Since health checks are CDI beans, you can do:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="java" class="language-java hljs">@ApplicationScoped
public class DatabaseHealthCheck {

    @Produces
    @ApplicationScoped
    @Liveness
    HealthCheck check1() {
      return () -&gt; HealthCheckResponse
                    .named("successful-live").up()
                    .build();
    }
    @Produces
    @ApplicationScoped
    @Readiness
    HealthCheck check2() {
      return () -&gt; HealthCheckResponse
                    .named("successful-read").up()
                    .build();
    }
}</code></pre>
</div>
</div>
<p class="">You can ping liveness or readiness health checks individually by querying <code>/health/live</code> or <code>/health/ready</code>.</p>
<p class=""><strong>Metrics</strong></p>
<p class="">Quarkus can utilize the <a href="https://github.com/eclipse/microprofile-metrics">MicroProfile Metrics spec</a> to provide metrics support.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="bash" class="language-bash hljs">./mvnw quarkus:add-extension
  -Dextensions="io.quarkus:quarkus-smallrye-metrics"</code></pre>
</div>
</div>
<p class="">The metrics can be read with JSON or the OpenMetrics format.
An endpoint is registered automatically at <code>/metrics</code> providing default metrics.</p>
<p class="">MicroProfile Metrics annotations:</p>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Annotation</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><p class=""><code>@Timed</code></p></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><p class="">Method, constructor, or class as timed.</p></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><p class=""><code>@Metered</code></p></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><p class="">Method, constructor, or class as metered.</p></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><p class=""><code>@Counted</code></p></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><p class="">Method, constructor, or class as counted.</p></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><p class=""><code>@Gauge</code></p></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><p class="">Method or field as a gauge.</p></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><p class=""><code>@Metric</code></p></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><p class="">Requesting that a metric be injected or registered.</p></div></td>
</tr>
</tbody>
</table>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="java" class="language-java hljs">@GET
//...
@Timed(name = "checksTimer",
description = "A measure of how long it takes
                                to perform a hello.",
unit = MetricUnits.MILLISECONDS)
public String hello() {}</code></pre>
</div>
</div>
<p class=""><code>@Gauge</code> annotation returning a measure as a gauge.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="java" class="language-java hljs">@Gauge(name = "hottestSauce", unit = MetricUnits.NONE,
description = "Hottest Sauce so far.")
public Long hottestSauce() {}</code></pre>
</div>
</div>
<p class="">Injecting a histogram using <code>@Metric</code>.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="java" class="language-java hljs">@Inject
@Metric(name = "histogram")
Histogram historgram;</code></pre>
</div>
</div>
<p class=""><strong>Tracing</strong></p>
<p class="">Quarkus can utilize the <a href="https://github.com/eclipse/microprofile-opentracing">MicroProfile OpenTracing</a> spec.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="bash" class="language-bash hljs">./mvnw quarkus:add-extension
  -Dextensions="io.quarkus:quarkus-smallrye-opentracing"</code></pre>
</div>
</div>
<p class="">Requests sent to any endpoint are traced automatically.</p>
<p class="">This extension includes OpenTracing support and <code>Jaeger</code> tracer.</p>
<p class="">Jaeger tracer configuration:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="properties" class="language-properties hljs">quarkus.jaeger.service-name=myservice
quarkus.jaeger.sampler-type=const
quarkus.jaeger.sampler-param=1
quarkus.jaeger.endpoint=http://localhost:14268/api/traces</code></pre>
</div>
</div>
<p class=""><code>@Traced</code> annotation can be set to disable tracing at class or method level.</p>
<p class=""><code>Tracer</code> class can be injected into the class.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="java" class="language-java hljs">@Inject
Tracer tracer;

tracer.activeSpan().setBaggageItem("key", "value");</code></pre>
</div>
</div>
<div class="page-break"></div>
</div>
</div>
<div class="sect1">
<h2 id="_cloud"><a class="anchor" href="#_cloud"></a><a class="link" href="#_cloud">Cloud</a></h2>
<div class="sectionbody">
<p class=""><strong>Native</strong></p>
<p class="">You can build a native image by using GraalVM.
The common use case is creating a Docker image so you can execute the next commands:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="bash" class="language-bash hljs">./mvnw package -Pnative -Dnative-image.docker-build=true

docker build -f src/main/docker/Dockerfile.native
                    -t quarkus/getting-started .
docker run -i --rm -p 8080:8080 quarkus/getting-started</code></pre>
</div>
</div>
<p class="">To configure native application, you can create a <code>config</code> directory at the same place as the native file and place an <code>application.properties</code> file inside. <code>config/application.properties</code>.</p>
<p class=""><strong>Kubernetes</strong></p>
<p class="">Quarks can use <a href="https://github.com/ap4k/ap4k">ap4k</a> to generate Kubernetes resources.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="bash" class="language-bash hljs">./mvnw quarkus:add-extensions
    -Dextensions="io.quarkus:quarkus-kubernetes"</code></pre>
</div>
</div>
<p class="">Running <code>./mvnw package</code> the Kubernetes resources are created at <code>target/wiring-classes/META-INF/kubernetes/</code> directory.</p>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Property</th>
<th class="tableblock halign-left valign-top">Default</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><p class=""><code>quarkus.kubernetes.group</code></p></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><p class="">Current username</p></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><p class="">Set Docker Username.</p></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><p class=""><code>quarkus.application.name</code></p></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><p class="">Current project name</p></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><p class="">Project name</p></div></td>
</tr>
</tbody>
</table>
<p class="">Generated resource is integrated with <a href="#_observability">MicroProfile Health annotations</a>.</p>
</div>
</div>
<div class="sect1">
<h2 id="_kubernetes_client"><a class="anchor" href="#_kubernetes_client"></a><a class="link" href="#_kubernetes_client">Kubernetes Client</a></h2>
<div class="sectionbody">
<p class="">Quarkus integrates with <a href="https://github.com/fabric8io/kubernetes-client">Fabric8 Kubernetes Client</a>.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="terminal" class="language-terminal hljs">./mvnw quarkus:add-extension
    -Dextensions="quarkus-kubernetes-client"</code></pre>
</div>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">
Currently you need to create a Kubernates Client producer by yourself, but this is gonna be improved in near future versions:
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="java" class="language-java hljs">@Dependent
public class KubernetesClientProducer {

    @Produces
    public KubernetesClient kubernetesClient() {
        Config config = new ConfigBuilder()
            .withMasterUrl("https://mymaster.com")
            .build();
        return new DefaultKubernetesClient(config);
    }
}</code></pre>
</div>
</div>
<p class="">And inject it on code:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="java" class="language-java hljs">@Inject
KubernetesClient client;

ServiceList myServices = client.services().list();

Service myservice = client.services()
        .inNamespace("default")
        .withName("myservice")
        .get();

CustomResourceDefinitionList crds = client
        .customResourceDefinitions()
        .list();

dummyCRD = new CustomResourceDefinitionBuilder()
        ...
        .build()
client.customResourceDefinitions()
        .create(dummyCRD);</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_amazon_lambda"><a class="anchor" href="#_amazon_lambda"></a><a class="link" href="#_amazon_lambda">Amazon Lambda</a></h2>
<div class="sectionbody">
<p class="">Quarkus integrates with Amazon Lambda.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="bash" class="language-bash hljs">./mvnw quarkus:add-extension
  -Dextensions="io.quarkus:quarkus-amazon-lambda"</code></pre>
</div>
</div>
<p class="">And then implement <code>com.amazonaws.services.lambda.runtime.RequestHandler</code> interface.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="java" class="language-java hljs">public class TestLambda
        implements RequestHandler&lt;MyInput, MyOutput&gt; {
    @Override
    public MyInput handleRequest(MyOutput input,
                                    Context context) {
    }
}</code></pre>
</div>
</div>
<div class="page-break"></div>
<p class=""><strong>Test</strong></p>
<p class="">You can write tests for Amazon lambdas:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="xml" class="language-xml hljs">&lt;dependency&gt;
  &lt;groupId&gt;io.quarkus&lt;/groupId&gt;
  &lt;artifactId&gt;quarkus-test-amazon-lambda&lt;/artifactId&gt;
  &lt;scope&gt;test&lt;/scope&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="java" class="language-java hljs">@Test
public void testLambda() {
    MyInput in = new MyInput();
    in.setGreeting("Hello");
    in.setName("Stu");
    MyOutput out = LambdaClient.invoke(MyOutput.class, in);
}</code></pre>
</div>
</div>
<div class="page-break"></div>
</div>
</div>
<div class="sect1">
<h2 id="_apache_camel"><a class="anchor" href="#_apache_camel"></a><a class="link" href="#_apache_camel">Apache Camel</a></h2>
<div class="sectionbody">
<p class="">Quarkus integrates wih <a href="https://camel.apache.org">Apache Camel</a>.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="bash" class="language-bash hljs">./mvnw quarkus:add-extension
  -Dextensions="io.quarkus:quarkus-camel-core"</code></pre>
</div>
</div>
<p class="">You can inject <code>CamelRuntime</code> and <code>CamelContext</code> instances:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="java" class="language-java hljs">@Inject
CamelRuntime runtime;

@Inject
CamelContext context;</code></pre>
</div>
</div>
<p class="">And also observing Camel events <code>InitializingEvent</code>, <code>InitializedEvent</code>, <code>StartingEvent</code>, <code>StartedEvent</code>. <code>StoppingEvent</code>, <code>StoppedEvent</code>.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="java" class="language-java hljs">public void init(@Observes InitializingEvent event) {
    runtime.getContext()
            .setUuidGenerator(new DefaultUuidGenerator());
}</code></pre>
</div>
</div>
<p class="">You can create <code>RouteBuilder</code> for routing rules:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="java" class="language-java hljs">public class CamelRoute extends RouteBuilder {

    @Override
    public void configure() {
        from("timer:keep-alive?" +
                "period={{camel.timer-route.period}}")
        .id("timer-route")
        .setBody(constant(""))
        .to("log:keep-alive");
    }
}</code></pre>
</div>
</div>
<p class="">Custom properties are set in <code>application.properties</code>.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="properties" class="language-properties hljs">camel.timer-route.period=1s</code></pre>
</div>
</div>
<p class="">List of Camel parameters.</p>
<p class=""><code>quarkus.</code> as a prefix is skipped in the next table.</p>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Default</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><p class=""><code>camel.routesUris</code></p></div></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Uri to an XML with camel routes.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><p class=""><code>camel.deferInitPhase</code></p></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><p class=""><code>false</code></p></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Defer context initialization phase until runtime.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><p class=""><code>camel.disableJaxb</code></p></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><p class=""><code>false</code></p></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Disable jaxb support at runtime. Useful when routes loaded at build time.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><p class=""><code>camel.disableXml</code></p></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><p class=""><code>false</code></p></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Disable XML support in various parts of Camel.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><p class=""><code>camel.dumpRoutes</code></p></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><p class=""><code>false</code></p></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Dump loaded routes .</p></td>
</tr>
</tbody>
</table>
<p class="">Quarkus also comes with support for Camel in form of next extensions: <code>camel-aws-s3</code>, <code>camel-aws-sqs</code>, <code>camel-infinispan</code>, <code>camel-netty4-http</code>, <code>camel-salesforce</code>.</p>
</div>
</div>
<div class="sect1">
<h2 id="_websockets"><a class="anchor" href="#_websockets"></a><a class="link" href="#_websockets">WebSockets</a></h2>
<div class="sectionbody">
<p class="">Quarkus can be used to handling web sockets.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="bash" class="language-bash hljs">./mvnw quarkus:add-extension
  -Dextensions="io.quarkus:quarkus-undertow-websockets"</code></pre>
</div>
</div>
<p class="">And web sockets classes can be used:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="java" class="language-java hljs">@ServerEndpoint("/chat/{username}")
@ApplicationScoped
public class ChatSocket {

    @OnOpen
    public void onOpen(Session session,
                @PathParam("username") String username) {}

    @OnClose
    public void onClose(..) {}

    @OnError
    public void onError(..., Throwable throwable) {}

    @OnMessage
    public void onMessage(...) {}

}</code></pre>
</div>
</div>
<div class="page-break"></div>
</div>
</div>
<div class="sect1">
<h2 id="_openapi"><a class="anchor" href="#_openapi"></a><a class="link" href="#_openapi">OpenAPI</a></h2>
<div class="sectionbody">
<p class="">Quarkus can expose its API description as <a href="https://swagger.io/specification/">OpenAPI</a> spec and test it using <a href="https://swagger.io/tools/swagger-ui/">Swagger UI</a>.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="bash" class="language-bash hljs">./mvnw quarkus:add-extension
  -Dextensions="io.quarkus:quarkus-smallrye-openapi"</code></pre>
</div>
</div>
<p class="">Then you only need to access to <code>/openapi</code> to get OpenAPI v3 spec of services.</p>
<p class="">You can update the OpenApi path by setting <code>quarkus.smallrye-openapi.path</code> property.</p>
<p class="">Also, in case of starting Quarkus application in <code>dev</code> or <code>test</code> mode, Swagger UI is accessible at <code>/swagger-ui</code>.
If you want to use it in production mode you need to set <code>quarkus.swagger-ui.always-include</code> property to <code>true</code>.</p>
<p class="">You can update the Swagger UI path by setting <code>quarkus.swagger-ui.path</code> property.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="properties" class="language-properties hljs">quarkus.swagger-ui.path=/my-custom-path</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_mail_sender"><a class="anchor" href="#_mail_sender"></a><a class="link" href="#_mail_sender">Mail Sender</a></h2>
<div class="sectionbody">
<p class="">You can send emails by using Quarkus Mailer extension:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="bash" class="language-bash hljs">./mvnw quarkus:add-extension
  -Dextensions="io.quarkus:quarkus-mailer"</code></pre>
</div>
</div>
<p class="">You can inject two possible classes <code>io.quarkus.mailer.Mailer</code> for synchronous API or <code>io.quarkus.mailer.ReactiveMailer</code> for asynchronous API.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="java" class="language-java hljs">@Inject
Mailer mailer;

@Inject
ReactiveMailer reactiveMailer;</code></pre>
</div>
</div>
<p class="">And then you can use them to send an email:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="java" class="language-java hljs">mailer.send(
    Mail.withText("to@acme.org", "Subject", "Body")
);

CompletionStage&lt;Void&gt; stage =
    reactiveMailer.send(
        Mail.withText("to@acme.org", "Subject", "Body")
    );</code></pre>
</div>
</div>
<p class=""><code>Mail</code> class contains methods to add <code>cc</code>, <code>bcc</code>, <code>headers</code>, <code>bounce address</code>, <code>reply to</code>, <code>attachments</code>, <code>inline attachments</code> and <code>html body</code>.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="java" class="language-java hljs">mailer.send(Mail.withHtml("to@acme.org", "Subject", body)
      .addInlineAttachment("quarkus.png",
            new File("quarkus.png"),
            "image/png", "&lt;my-image@quarkus.io&gt;"));</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
If you need deep control you can inject Vert.x mail client <code>@Inject  MailClient client;</code>
</td>
</tr>
</table>
</div>
<p class="">You need to configure SMTP properties to be able to send an email:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="properties" class="language-properties hljs">quarkus.mailer.from=test@quarkus.io
quarkus.mailer.host=smtp.sendgrid.net
quarkus.mailer.port=465
quarkus.mailer.ssl=true
quarkus.mailer.username=....
quarkus.mailer.password=....</code></pre>
</div>
</div>
<p class="">List of Mailer parameters.
<code>quarkus.</code> as a prefix is skipped in the next table.</p>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Parameter</th>
<th class="tableblock halign-left valign-top">Default</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><p class=""><code>mailer.from</code></p></div></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><div class="content"><p class="">Default address.</p></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><p class=""><code>mailer.mock</code></p></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><p class="">false in <code>prod</code>, true in <code>dev</code> and <code>test</code>.</p></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Emails not sent, just printed and stored in a <code>MockMailbox</code> bean.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><p class=""><code>mailer.bounce-address</code></p></div></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Default address.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><p class=""><code>mailer.host</code></p></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><p class=""><em>mandatory</em></p></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">SMTP host.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><p class=""><code>mailer.port</code></p></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">25</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">SMTP port.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><p class=""><code>mailer.username</code></p></div></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The username.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><p class=""><code>mailer.password</code></p></div></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The password.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><p class=""><code>mailer.ssl</code></p></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><p class=""><code>false</code></p></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Enables SSL.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><p class=""><code>mailer.trust-all</code></p></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Trust all certificates.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><p class=""><code>mailer.max-pool-size</code></p></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">10</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Maximum number of open connections .</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><p class=""><code>mailer.own-host-name</code></p></div></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><div class="content"><p class="">Hostname for <code>HELO/EHLO</code> and <code>Message-ID</code></p></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><p class=""><code>mailer.keep-alive</code></p></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><p class=""><code>true</code></p></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Connection pool enabled.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><p class=""><code>mailer.disable-esmtp</code></p></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><p class=""><code>false</code></p></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Disable ESMTP.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><p class=""><code>mailer.start-tls</code></p></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><p class=""><code>OPTIONAL</code></p></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><p class="">TLS security mode. <code>NONE</code>, <code>OPTIONAL</code>, <code>REQUIRED</code>.</p></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><p class=""><code>mailer.login</code></p></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><p class=""><code>NONE</code></p></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><p class="">Login mode. <code>NONE</code>, <code>OPTIONAL</code>, <code>REQUIRED</code>.</p></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><p class=""><code>mailer.auth-methods</code></p></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">All methods.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Space-separated list.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><p class=""><code>mailer.key-store</code></p></div></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Path of the key store.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><p class=""><code>mailer.key-store-password</code></p></div></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Key store password.</p></td>
</tr>
</tbody>
</table>
<p class=""><strong>Testing</strong></p>
<p class="">If <code>quarkus.mailer.mock</code> is set to <code>true</code>, which is the default value in <code>dev</code> and <code>test</code> mode, you can inject <code>MockMailbox</code> to get the sent messages.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="java" class="language-java hljs">@Inject
MockMailbox mailbox;

@BeforeEach
void init() {
    mailbox.clear();
}

List&lt;Mail&gt; sent = mailbox
                    .getMessagesSentTo("to@acme.org");</code></pre>
</div>
</div>
<div class="page-break"></div>
</div>
</div>
<div class="sect1">
<h2 id="_scheduled_tasks"><a class="anchor" href="#_scheduled_tasks"></a><a class="link" href="#_scheduled_tasks">Scheduled Tasks</a></h2>
<div class="sectionbody">
<p class="">You can schedule periodic tasks with Quarkus.</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="java" class="language-java hljs">@ApplicationScoped
public class CounterBean {

    @Scheduled(every="10s")
    void increment() {}

    @Scheduled(cron="0 15 10 * * ?")
    void morningTask() {}
}</code></pre>
</div>
</div>
<p class=""><code>every</code> and <code>cron</code> parameters can be surrounded with <code>{}</code> and the value is used as config property to get the value.</p>
<div class="listingblock">
<div class="content">
<pre>@Scheduled(cron = "{morning.check.cron.expr}")
void morningTask() {}</pre>
</div>
</div>
<p class="">And configure the property into <code>application.properties</code>:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="properties" class="language-properties hljs">morning.check.cron.expr=0 15 10 * * ?</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_kogito"><a class="anchor" href="#_kogito"></a><a class="link" href="#_kogito">Kogito</a></h2>
<div class="sectionbody">
<p class="">Quarkus integrates with <a href="http://www.kiegroup.org/">Kogito</a>, a next-generation business automation toolkit from Drools and jBPM projects for adding business automation capabilities.</p>
<p class="">To start using it you only need to add the next extension:</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code data-lang="bash" class="language-bash hljs">./mvnw quarkus:add-extension
  -Dextensions="kogito"</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_resources"><a class="anchor" href="#_resources"></a><a class="link" href="#_resources">Resources</a></h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><a href="https://quarkus.io/guides/" class="bare">https://quarkus.io/guides/</a></p>
</li>
<li>
<p><a href="https://www.youtube.com/user/lordofthejars" class="bare">https://www.youtube.com/user/lordofthejars</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1 authors">
<h3>Authors :</h3>
<div class="author">
<div class="author-avatar"><img src="http://avatars.io/twitter/alexsotob"/></div>
<div class="author-name"><a href="https://twitter.com/alexsotob">@alexsotob</a></div>
<div class="author-bio">Java Champion and SW Engineer at Red Hat</div>
</div>

<div class="author-bio">0.18.0</div>
<img src="./redhat/assets/by-nc-sa.png"/>
</div>

</section>
</body>